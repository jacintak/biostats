<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical modelling 2: Multiple regression</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="../../../jacintak.github.io/styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Jacinta's GitHub</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Mechanistic models of ectotherm development
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://jacintak.github.io/model-about.html">About</a>
    </li>
    <li>
      <a href="https://jacintak.github.io/model-pipeline.html">Pipeline</a>
    </li>
    <li>
      <a href="https://jacintak.github.io/model-resources.html">Resources</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Teaching intro statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r-exams-guide.html">Quick guide to R/exams</a>
    </li>
    <li>
      <a href="Drop_in_1.html">Introduction to R</a>
    </li>
    <li>
      <a href="biostats-GLM1.html">Lecture 1: Simple linear models</a>
    </li>
    <li>
      <a href="biostats-GLM2.html">Lecture 2: Multiple regression</a>
    </li>
    <li>
      <a href="biostats-GLM3.html">Lecture 3: Evaluating models</a>
    </li>
    <li>
      <a href="GLM-Assumptions-worksheet.html">Worksheet for Lecture 3: Checking Assumptions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    colRoz
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://jacintak.github.io/colRoz/index.html">Quick guide to colRoz</a>
    </li>
    <li>
      <a href="https://jacintak.github.io/colRoz/colRoz-palettes.html">Palettes</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jacintak">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical modelling 2: Multiple regression</h1>
<h4 class="date">13-Nov-2020</h4>

</div>


<hr />
<div id="overall-lecture-aims" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Overall lecture aims</h1>
<ul>
<li>Identify the structure of general linear models</li>
<li>Describe how linear models are parametrized</li>
<li>Understand how to use linear models</li>
<li>Understand how to interpret and evaluate linear models</li>
</ul>
<p>Recommended reading:
Chapter 5.5 Getting Started with R</p>
<div id="other-resources" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Other resources</h2>
<ul>
<li>Seeing Theory. Chapter 6. <a href="https://seeing-theory.brown.edu/regression-analysis/index.html" class="uri">https://seeing-theory.brown.edu/regression-analysis/index.html</a></li>
<li>Statistics: an introduction using R. Michael J. Crawley. Wiley Press. Chapters 7 - 11.</li>
<li>Experimental Design and Data Analysis for Biologists. Gerry P. Quinn &amp; Michael J. Keough. Cambridge Press. Chapters 5, 6, 8, 12.</li>
<li>R for Data Science (For more advanced R). <a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a></li>
<li><a href="https://learningstatisticswithr.com/book/index.html" class="uri">https://learningstatisticswithr.com/book/index.html</a></li>
<li><a href="http://mfviz.com/hierarchical-models/">An interactive visual explanation of hierarchical Models</a></li>
</ul>
</div>
<div id="using-datasets" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Using datasets</h2>
<p>Datasets used here are from the package <code>MASS</code> which comes with R. To use any data in <code>MASS</code>, <code>library(MASS)</code> needs to be called first.</p>
</div>
<div id="by-the-end-of-this-lecture-you-should" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> By the end of this lecture you should:</h2>
<ul>
<li>Understand the parameters of a linear model with multiple predictor variables</li>
<li>Parametrise and use a multiple regression model to predict values from the R output of a linear regression</li>
<li>Interpret and complete ANOVA tables with multiple predictor variables</li>
<li>Understand an interaction between two predictor variables</li>
<li>Conduct a multiple regression in R with 2 continuous or categorical predictor variables or a combination</li>
</ul>
<hr />
</div>
</div>
<div id="previously-we-parametrised-slopes-and-intercepts-of-simple-linear-models" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Previously, we parametrised slopes and intercepts of simple linear models</h1>
<p>With one continuous response variable and one continuous predictor variable</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 X\]</span></p>
<p>where the parameters <span class="math inline">\(\beta_0\)</span> = intercept and <span class="math inline">\(\beta_1\)</span> = slope</p>
<p><img src="biostats-GLM2_files/figure-html/general-lm-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>So far these parameters have been <em>fixed</em>…</p>
</div>
<div id="parameters-of-a-linear-model-can-be-random-or-fixed" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Parameters of a linear model can be <strong>random</strong> or <strong>fixed</strong></h1>
<ul>
<li>Important to consider when designing experiments – you decide!</li>
<li>Changes the hypotheses &amp; interpretation of results</li>
<li>Fixed:
Constant across all groupings (how observations are related – e.g. populations of individuals)</li>
<li>Random:
Vary across groupings, or represent a random sample from a larger population</li>
</ul>
<div id="fixed-slopes-linear-model" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fixed slopes linear model</h2>
<ul>
<li>All groups (Frequency of exercise in this example) have the same slope</li>
<li>Response of groups to predictor variable x is consistent across groups</li>
<li>Cannot extrapolate beyond groups</li>
<li><em>Thus can only draw conclusions for these groups</em></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:fixed-slopes-model"></span>
<img src="biostats-GLM2_files/figure-html/fixed-slopes-model-1.png" alt="Height of students of various frequencies of exercise and hand width" width="300" />
<p class="caption">
Figure 3.1: Height of students of various frequencies of exercise and hand width
</p>
</div>
</div>
<div id="random-slopes-linear-model" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Random slopes linear model</h2>
<ul>
<li>All groups have different slopes</li>
<li>Response of groups to predictor variable x varies among groups</li>
<li>Can extrapolate beyond observed groups</li>
<li>Identity of group is not the main question</li>
<li><em>Thus can generalise to other groups outside study</em></li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:random-slopes-model"></span>
<img src="biostats-GLM2_files/figure-html/random-slopes-model-1.png" alt="Each group has a different slope" width="300" />
<p class="caption">
Figure 3.2: Each group has a different slope
</p>
</div>
</div>
<div id="distinguishing-between-fixed-or-random-is-important" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Distinguishing between Fixed or random is important</h2>
<blockquote>
<p>Changes the way Analysis of Variance (ANOVA) is calculated</p>
</blockquote>
<ul>
<li>Changes formula for Mean Sum of Squares</li>
<li>Changes numerator/denominator of F ratio</li>
<li>Thus changes interpretation</li>
<li>Called Type I (fixed), II (random) or III (mixed)</li>
</ul>
<hr />
</div>
</div>
<div id="t-tests-simple-linear-models-anova" class="section level1" number="4">
<h1><span class="header-section-number">4</span> t-tests, simple linear models, ANOVA</h1>
<ul>
<li>Predictor variables can be categorical (called factors in R), like exercise in Figures <a href="#fig:fixed-slopes-model">3.1</a> &amp; <a href="#fig:random-slopes-model">3.2</a></li>
<li>Can have two or more sub-categories (called levels in R)
<ul>
<li>E.g. sex: male/female, level of drug: low/medium/high</li>
</ul></li>
</ul>
<p>Typically, the relationship between a continuous response variable &amp; categorical predictors is analysed using a special case of statistical models: One-way Analysis of Variance (ANOVA)</p>
<p>Confusingly, ANOVA can refer to how data are spread around a single mean (<em>variance</em>) and also a way of comparing means (via how similar their variances are) for experimental designs with a predictor variable with any number of levels.</p>
</div>
<div id="fixed-one-way-anova-with-2-or-more-levels" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Fixed one-way ANOVA with 2 or more levels</h1>
<ul>
<li>level = subsets within categories
<ul>
<li>e.g. male/female, low/medium/high</li>
</ul></li>
<li>We are testing means for each level</li>
<li>What is the null hypothesis?</li>
</ul>
<blockquote>
<p><span class="math inline">\(H_0:\)</span> All levels come from the same population (have the same mean)</p>
</blockquote>
<div id="pulse-rate-and-exercise" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Pulse rate and exercise</h2>
<p><img src="biostats-GLM2_files/figure-html/pulse-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>We can do an ANOVA and get the following output:</p>
<pre><code>Analysis of Variance Table

Response: Pulse
           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
Exer        2   900.5  450.23  3.3783 0.03618 *
Residuals 189 25188.2  133.27                  
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<blockquote>
<p>Conclusions: We can reject the null hypothesis that there is no difference in mean pulse rate of students with different amount of exercise</p>
</blockquote>
<p>Report the degrees of freedom (df), the F ratio and the P value like
<span class="math display">\[F_{2,189} = 3.38, P = 0.036\]</span>
Where 2 is the df of the groups (<code>Exer</code>) and 189 is the df of the residual error (<code>Residuals</code>).</p>
</div>
<div id="the-anova-table" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The ANOVA table</h2>
<table style="width:100%;">
<colgroup>
<col width="56%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Source of variation</th>
<th align="center">SS</th>
<th align="center">df</th>
<th align="center">MS</th>
<th align="center">F</th>
<th>P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Variance among groups</td>
<td align="center">SSR</td>
<td align="center">number of levels - 1</td>
<td align="center"><span class="math inline">\(MSR = \frac{SSR}{df}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MSR}{MSE}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Variance within group</td>
<td align="center">SSE</td>
<td align="center">number of observations - 2</td>
<td align="center"><span class="math inline">\(MSE = \frac{SSE}{df}\)</span></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Total error</td>
<td align="center">SSY</td>
<td align="center">total number of observations - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="calculating-group-means" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Calculating group means</h2>
<p>Check <code>summary()</code> to see group means</p>
<pre><code>
Call:
lm(formula = Pulse ~ Exer, data = survey)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.188  -7.968  -0.188   7.812  32.032 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   71.968      1.184  60.763   &lt;2e-16 ***
ExerNone       4.796      3.040   1.578    0.116    
ExerSome       4.219      1.752   2.408    0.017 *  
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 11.54 on 189 degrees of freedom
  (45 observations deleted due to missingness)
Multiple R-squared:  0.03452,   Adjusted R-squared:  0.0243 
F-statistic: 3.378 on 2 and 189 DF,  p-value: 0.03618</code></pre>
<ul>
<li>Groups are calculated in alphabetical order - Here “Frequent” group is calculated first</li>
<li><code>Estimate</code> column shows the <strong>difference in means</strong> - see below</li>
<li>P values test differences in <strong>pairs of means</strong> BUT should we be doing multiple comparisons? (no)</li>
</ul>
<p>Model coefficients:</p>
<pre><code>(Intercept)    ExerNone    ExerSome 
  71.968421    4.796285    4.219079 </code></pre>
<p>R-calculated means:</p>
<pre><code>    Freq     None     Some 
71.96842 76.76471 76.18750 </code></pre>
<p>Manually calculated means for “None” group:
71.9684211 + 4.7962848 = 76.7647059</p>
<p>Manually calculated means for “Some” group:
71.9684211 + 4.2190789 = 76.1875</p>
</div>
</div>
<div id="anova-and-hypothesis-testing" class="section level1" number="6">
<h1><span class="header-section-number">6</span> ANOVA and hypothesis testing</h1>
<p><strong>Important to remember:</strong></p>
<ul>
<li>ANOVA is a test of means (analysis of variance about the mean)</li>
<li>F-ratio tells you that there is a difference in the means between pairs of groups but NOT which pairs are different</li>
<li>Need post-hoc tests like Tukey’s Honest Significant Differences (not covered in this lecture) to see <em>which pairs</em> are significantly different</li>
</ul>
<hr />
</div>
<div id="recap-time" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Recap time!</h1>
<p>Test your understanding so far by answering the questions below. Click <code>Code</code> to see the answer.</p>
<p>What is the significance of fixed and random variables for drawing conclusions?</p>
<pre class="r fold-hide"><code>It changes the inferred conclusion. In fixed models, the identities of the groupings are the main level of inference whereas in random models we consider the identity of the group to be randomly selected from a wider pool of candidates. Thus we can generalise our findings beyond our selected groups in random models but are limited to the groups we selected in fixed models. 

For example, if we counted the population of 5 towns in Ireland and analysed the data using a fixed model, then we could only state our conclusion for those 5 towns and cannot draw conclusions for the whole of Ireland.

With a random model, we consider those 5 towns to be representitive of the whole of Ireland, we are not interested in those 5 towns in particular, thus we can generalise our conclusions to the whole of Ireland. E.g. those 5 towns were randomly selected from all the candidate towns to survey.</code></pre>
<p>What is the function to conduct an Analysis of Variance in R?</p>
<pre class="r fold-hide"><code>Either summary(aov()) or anova(lm()) will do a Type I ANOVA. Type II and Type III models require additional packages.</code></pre>
<p>How many groups were in the categorical predictor variable in this one-way analysis of variance? <span class="math inline">\(F_{5,24} = 14.23, P &lt; 0.001\)</span></p>
<pre class="r fold-hide"><code>6 groups. The degree of freedom for group is 5 and this is calculated from the number of groups - 1. So 5 + 1 = 6.</code></pre>
<hr />
</div>
<div id="multiple-regression" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Multiple regression</h1>
<p>We can include more than 1 predictor variable in our models</p>
<blockquote>
<p>Multiple regression: Linear models with two or more predictor variables</p>
</blockquote>
<ul>
<li>Models the effect of multiple predictors on response</li>
<li>Two-way ANOVAs etc. are special cases of multiple regression</li>
<li>If 3 categorical predictors, then three-way ANOVA etc…</li>
<li>With more predictor variables, the model becomes complex
<ul>
<li>And potentially less informative/difficult to interpret</li>
<li>Remember the trade-off between generality &amp; complexity</li>
<li>Keep it simple</li>
</ul></li>
</ul>
<div id="height-and-hand-width" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Height and hand width</h2>
<p>Imagine we asked the class ‘is there a relationship between your height and the width of your hand?’<br />
The linear model is:</p>
<p><span class="math display">\[ height  = \beta_0 + \beta_1 hand \space width + \varepsilon_i\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:hand-height"></span>
<img src="biostats-GLM2_files/figure-html/hand-height-1.png" alt="The relationship between hand width and height of students" width="300" />
<p class="caption">
Figure 8.1: The relationship between hand width and height of students
</p>
</div>
<p>Good, but let’s ask is it also important to consider the sex of the student?</p>
<div class="figure" style="text-align: center"><span id="fig:hand-height-sex"></span>
<img src="biostats-GLM2_files/figure-html/hand-height-sex-1.png" alt="The relationship between hand width and height of male (yellow) or female (purple) students" width="300" />
<p class="caption">
Figure 8.2: The relationship between hand width and height of male (yellow) or female (purple) students
</p>
</div>
<blockquote>
<p>Does including information about sex improve our ability to detect/understand patterns?</p>
</blockquote>
<p>The linear model now has two predictor variables and is written as:</p>
<p><span class="math display">\[ height  = \beta_0 + \beta_{sex} hand \space width + \varepsilon_i\]</span>
Notice that the slope parameter (<span class="math inline">\(\beta_{sex}\)</span>) now specifies that it is dependent on the sex of the student.</p>
<p>Since Sex is a categorical predictor with 2 levels, this model now describes two lines - one for each level of the predictor (male/female)</p>
<div id="does-student-height-vary-with-hand-width-and-between-sexes" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Does student height vary with hand width and between sexes?</h3>
<ul>
<li>Continuous response</li>
<li>Categorical predictor</li>
<li>Continuous predictor (also called covariate)</li>
<li>Can be analysed using multiple linear models</li>
<li>Two types:
<ul>
<li>Additive model (<strong>Fixed slopes model</strong>)</li>
<li>Interactive model (<strong>Random slopes model</strong>)</li>
</ul></li>
</ul>
<p>Analysis of Covariance is a special case with unique assumptions (not considered here), else called a general linear model</p>
</div>
</div>
<div id="fixed-slopes-additive-model" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Fixed slopes (additive model)</h2>
<ul>
<li>No interaction term</li>
<li>Same slope</li>
<li>Intercept for each sex</li>
<li>in <code>R</code>: <code>lm(Y ~ A + B, data)</code> where A &amp; B are the two predictor variables</li>
</ul>
<blockquote>
<p>H0: There is no effect of A or B on the response variable
H1: There is an effect of A or B on the response variable</p>
</blockquote>
<div class="figure" style="text-align: center"><span id="fig:same-slope"></span>
<img src="biostats-GLM2_files/figure-html/same-slope-1.png" alt="the lines are parallel to each other" width="300" />
<p class="caption">
Figure 8.3: the lines are parallel to each other
</p>
</div>
<pre><code>(Intercept)      Wr.Hnd     SexMale 
 137.686951    1.594446    9.489814 </code></pre>
<p>Parametrised slope for females:<br />
<em>Female height</em> = 137.687 + 1.594 <em>hand width</em></p>
<p>Parametrised slope for males:<br />
<em>Male height</em> = (137.687 + 9.49) + 1.594 <em>hand width</em></p>
<blockquote>
<p>Remember R shows the difference between parameter estimates so you need to extract the correct values</p>
</blockquote>
</div>
<div id="random-slopes-interactive-model" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Random slopes (interactive model)</h2>
<p>The random slopes model has in interaction term. In R this is coded <code>lm(Height ~ Wr.Hnd * Sex, survey)</code>.</p>
<p>The linear model is now:</p>
<p><span class="math display">\[ height  = \beta_{0_{sex}} + \beta_{sex} hand \space width + \varepsilon_i\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:random-slopes"></span>
<img src="biostats-GLM2_files/figure-html/random-slopes-1.png" alt="The lines have different slopes and intercepts" width="300" />
<p class="caption">
Figure 8.4: The lines have different slopes and intercepts
</p>
</div>
<pre><code>   (Intercept)         Wr.Hnd        SexMale Wr.Hnd:SexMale 
   147.4497131      1.0385045     -7.1567184      0.9020249 </code></pre>
<p>To parametrise the model we now need to calculate different values for slopes. In the coefficient list, <code>Wr.Hnd:SexMale</code> is the <strong>difference in the value of the slope relative to the slope for female</strong> <code>Wr.Hnd</code>. Remember: female is alphabetically before male so R calculates the variances for females first, then males.</p>
<p>Parametrised slope for females:<br />
<em>Female height</em> = 147.45 + 1.039 <em>hand width</em></p>
<p>Parametrised slope for males:<br />
<em>Male height</em> = (147.45 -7.157) + (1.039 + 0.902) <em>hand width</em></p>
<blockquote>
<p>H0: There is no effect of A or B or their interaction on the response variable
H1: There is an effect of A or B or their interaction on the response variable</p>
</blockquote>
<hr />
</div>
<div id="the-multiple-regression-anova-table" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> The multiple regression ANOVA table</h2>
<blockquote>
<p>Variance of predictors (SS) is partitioned out from total SS in order it is entered in to R</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Wr.Hnd</td>
<td align="right">1</td>
<td align="right">7298.70354</td>
<td align="right">7298.70354</td>
<td align="right">150.128633</td>
<td align="right">3.359137e-26</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">2912.37262</td>
<td align="right">2912.37262</td>
<td align="right">59.905231</td>
<td align="right">4.604092e-13</td>
</tr>
<tr class="odd">
<td align="left">Wr.Hnd:Sex</td>
<td align="right">1</td>
<td align="right">90.06608</td>
<td align="right">90.06608</td>
<td align="right">1.852589</td>
<td align="right">1.749916e-01</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">203</td>
<td align="right">9869.11550</td>
<td align="right">48.61633</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="the-anova-table-for-2-predictors-and-their-interaction" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> The ANOVA table for 2 predictors and their interaction</h2>
<table>
<thead>
<tr class="header">
<th align="center">Source of variation</th>
<th align="center">SS</th>
<th align="center">df</th>
<th align="center">MS</th>
<th align="center">F</th>
<th>P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Factor A</td>
<td align="center">SSR of A</td>
<td align="center">number of levels of A - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Factor B</td>
<td align="center">SSR of B</td>
<td align="center">number of levels of B - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Factor A x B</td>
<td align="center">SSR of A &amp; B</td>
<td align="center">df of A x df of B</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="even">
<td align="center">Within error</td>
<td align="center">SSE</td>
<td align="center">levels of A x levels of B X (number of observations - 1)</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr class="odd">
<td align="center">Total error</td>
<td align="center">SSY</td>
<td align="center">(levels of A x levels of B X number of observations) - 1</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="interpreting-the-anova-table" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Interpreting the ANOVA table</h2>
<blockquote>
<p>P(Interaction term) &gt; 0.05, thus the effect of hand width on
student height is not dependent of the sex of the student</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Wr.Hnd</td>
<td align="right">1</td>
<td align="right">7298.70354</td>
<td align="right">7298.70354</td>
<td align="right">150.128633</td>
<td align="right">3.359137e-26</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">2912.37262</td>
<td align="right">2912.37262</td>
<td align="right">59.905231</td>
<td align="right">4.604092e-13</td>
</tr>
<tr class="odd">
<td align="left">Wr.Hnd:Sex</td>
<td align="right">1</td>
<td align="right">90.06608</td>
<td align="right">90.06608</td>
<td align="right">1.852589</td>
<td align="right">1.749916e-01</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">203</td>
<td align="right">9869.11550</td>
<td align="right">48.61633</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="the-interaction-term-ab" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> The interaction term A:B</h2>
<ul>
<li>Measures the dependence of the level of one factor on the level of the other factors</li>
<li>If interaction term is not significant:
<ul>
<li>effect of one factor on other is additive (independent of each other)</li>
</ul></li>
<li>If significant:
<ul>
<li>indicates synergistic or antagonistic effects between factors</li>
<li>Should be main conclusion of analysis</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="the-fundamentals-of-linear-regression" class="section level1" number="9">
<h1><span class="header-section-number">9</span> The fundamentals of Linear regression</h1>
<p>That’s the basics of linear regression!<br />
They are widely used in biological statistics so you’ll likely come across them when reading scientific studies.</p>
<p>The same concepts apply for any number or combination of predictor variables. Two, three, four predictor variables and so forth…it just becomes more complex to parameterise.</p>
<p>Remember, the aim is to quantify how much variation in the response variable is attributable to each predictor variable - minimise those residuals!</p>
<p>Common statistical analyses you should be able to do by applying the concepts in these lectures:
1 continuous response variable &amp;:</p>
<ul>
<li>1 continuous predictor variable - simple linear regression</li>
<li>2 continuous predictor variables (with/without their interaction) - multiple regression</li>
<li>1 categorical predictor variable - One-way ANOVA</li>
<li>1 continuous predictor variable &amp; 1 categorical predictor variable (with/without their interaction) - ANCOVA/multiple regression</li>
<li>2 categorical predictor variables (with/without their interaction) - Two-way ANOVA</li>
</ul>
<hr />
</div>
<div id="recap-time-1" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Recap time!</h1>
<p>Test your understanding so far by answering the questions below. Click <code>Code</code> to see the answer.</p>
<p>What is the difference between an additive and interactive linear model?</p>
<pre class="r fold-hide"><code>An additive model does not describe an interaction between the two predictor variables. An interactive model describes that the effect of one predictor variable on the response variable is dependent on the second predictor variable.</code></pre>
<p>What is the function to conduct an interactive multiple regression model in R?</p>
<pre class="r fold-hide"><code>lm(Y ~ A * B, data) where A &amp; B are the two predictor variables. * denotes the interaction.</code></pre>
<p>A multiple regression of crab shell width (response) with crab body depth (continuous predictor) for two species (categorical predictor: B or O) and their interaction had the following coefficients:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6942643</td>
</tr>
<tr class="even">
<td align="left">BD</td>
<td align="right">2.5449206</td>
</tr>
<tr class="odd">
<td align="left">spO</td>
<td align="right">-1.2531624</td>
</tr>
<tr class="even">
<td align="left">BD:spO</td>
<td align="right">-0.1756934</td>
</tr>
</tbody>
</table>
<p>What is the predicted shell length (mm) of a species O crab with a body depth of 15mm?</p>
<pre class="r fold-hide"><code>Answer: 36.97951 mm

Because B is alphabetically before O, the first parameter coefficients refer to species B. 
The intercept for species O is 2.6942643-1.2531624 = 1.441102
The slope for species O is  2.5449206-0.1756934 = 2.369227
Thus the whole model for species O is:
  shell length = 2.369227 * body depth + 1.441102

Using a value of 15 for body depth:
  shell length = 2.369227 * 15 + 1.441102
               = 36.97951 mm</code></pre>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlN0YXRpc3RpY2FsIG1vZGVsbGluZyAyOiBNdWx0aXBsZSByZWdyZXNzaW9uIg0KZGF0ZTogImByIGZvcm1hdChTeXMuRGF0ZSgpLCAnJWQtJWItJVknKWAiDQplZGl0b3Jfb3B0aW9uczoNCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUNCi0tLQ0KDQpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0NCmxpYnJhcnkoa25pdHIpDQpvcHRzX2NodW5rJHNldChlY2hvID0gRiwgd2FybmluZyA9IEZBTFNFLCBtZXNzYWdlID0gRkFMU0UsIGNvbW1lbnQgPSBOQSwgZmlnLmhlaWdodCA9IDMsIGZpZy53aWR0aCA9IDMsIGRwaSA9IDEwMCwgZmlnLmFsaWduID0gImNlbnRlciIsIGZpZy5zaG93ID0gImhvbGQiKQ0KbGlicmFyeSh0aWR5dmVyc2UpDQp0aGVtZV9zZXQodGhlbWVfY2xhc3NpYygpKQ0KbGlicmFyeShNQVNTKQ0Kb3B0aW9ucyhnZ3Bsb3QyLmNvbnRpbnVvdXMuY29sb3VyPSJ2aXJpZGlzIikNCnNjYWxlX2NvbG91cl9kaXNjcmV0ZSA8LSBmdW5jdGlvbiguLi4pICAgc2NhbGVfY29sb3VyX3ZpcmlkaXNfZCgpDQpgYGANCioqKg0KDQojIE92ZXJhbGwgbGVjdHVyZSBhaW1zDQoNCiogSWRlbnRpZnkgdGhlIHN0cnVjdHVyZSBvZiBnZW5lcmFsIGxpbmVhciBtb2RlbHMNCiogRGVzY3JpYmUgaG93IGxpbmVhciBtb2RlbHMgYXJlIHBhcmFtZXRyaXplZA0KKiBVbmRlcnN0YW5kIGhvdyB0byB1c2UgbGluZWFyIG1vZGVscw0KKiBVbmRlcnN0YW5kIGhvdyB0byBpbnRlcnByZXQgYW5kIGV2YWx1YXRlIGxpbmVhciBtb2RlbHMNCg0KUmVjb21tZW5kZWQgcmVhZGluZzoNCkNoYXB0ZXIgNS41IEdldHRpbmcgU3RhcnRlZCB3aXRoIFINCg0KIyMgT3RoZXIgcmVzb3VyY2VzDQogDQoqIFNlZWluZyBUaGVvcnkuIENoYXB0ZXIgNi4gaHR0cHM6Ly9zZWVpbmctdGhlb3J5LmJyb3duLmVkdS9yZWdyZXNzaW9uLWFuYWx5c2lzL2luZGV4Lmh0bWwNCiogU3RhdGlzdGljczogYW4gaW50cm9kdWN0aW9uIHVzaW5nIFIuIE1pY2hhZWwgSi4gQ3Jhd2xleS4gV2lsZXkgUHJlc3MuIENoYXB0ZXJzIDcgLSAxMS4NCiogRXhwZXJpbWVudGFsIERlc2lnbiBhbmQgRGF0YSBBbmFseXNpcyBmb3IgQmlvbG9naXN0cy4gR2VycnkgUC4gUXVpbm4gJiBNaWNoYWVsIEouIEtlb3VnaC4gQ2FtYnJpZGdlIFByZXNzLiBDaGFwdGVycyA1LCA2LCA4LCAxMi4NCiogUiBmb3IgRGF0YSBTY2llbmNlIChGb3IgbW9yZSBhZHZhbmNlZCBSKS4gaHR0cHM6Ly9yNGRzLmhhZC5jby5uei9pbmRleC5odG1sDQoqIGh0dHBzOi8vbGVhcm5pbmdzdGF0aXN0aWNzd2l0aHIuY29tL2Jvb2svaW5kZXguaHRtbA0KKiBbQW4gaW50ZXJhY3RpdmUgdmlzdWFsIGV4cGxhbmF0aW9uIG9mIGhpZXJhcmNoaWNhbCBNb2RlbHNdKGh0dHA6Ly9tZnZpei5jb20vaGllcmFyY2hpY2FsLW1vZGVscy8pDQoNCiMjIFVzaW5nIGRhdGFzZXRzDQoNCkRhdGFzZXRzIHVzZWQgaGVyZSBhcmUgZnJvbSB0aGUgcGFja2FnZSBgTUFTU2Agd2hpY2ggY29tZXMgd2l0aCBSLiBUbyB1c2UgYW55IGRhdGEgaW4gYE1BU1NgLCBgbGlicmFyeShNQVNTKWAgbmVlZHMgdG8gYmUgY2FsbGVkIGZpcnN0Lg0KDQojIyBCeSB0aGUgZW5kIG9mIHRoaXMgbGVjdHVyZSB5b3Ugc2hvdWxkOg0KDQoqIFVuZGVyc3RhbmQgdGhlIHBhcmFtZXRlcnMgb2YgYSBsaW5lYXIgbW9kZWwgd2l0aCBtdWx0aXBsZSBwcmVkaWN0b3IgdmFyaWFibGVzDQoqIFBhcmFtZXRyaXNlIGFuZCB1c2UgYSBtdWx0aXBsZSByZWdyZXNzaW9uIG1vZGVsIHRvIHByZWRpY3QgdmFsdWVzIGZyb20gdGhlIFIgb3V0cHV0IG9mIGEgbGluZWFyIHJlZ3Jlc3Npb24NCiogSW50ZXJwcmV0IGFuZCBjb21wbGV0ZSBBTk9WQSB0YWJsZXMgd2l0aCBtdWx0aXBsZSBwcmVkaWN0b3IgdmFyaWFibGVzDQoqIFVuZGVyc3RhbmQgYW4gaW50ZXJhY3Rpb24gYmV0d2VlbiB0d28gcHJlZGljdG9yIHZhcmlhYmxlcyANCiogQ29uZHVjdCBhIG11bHRpcGxlIHJlZ3Jlc3Npb24gaW4gUiB3aXRoIDIgY29udGludW91cyBvciBjYXRlZ29yaWNhbCBwcmVkaWN0b3IgdmFyaWFibGVzIG9yIGEgY29tYmluYXRpb24NCg0KKioqDQoNCiMgUHJldmlvdXNseSwgd2UgcGFyYW1ldHJpc2VkIHNsb3BlcyBhbmQgaW50ZXJjZXB0cyBvZiBzaW1wbGUgbGluZWFyIG1vZGVscw0KDQpXaXRoIG9uZSBjb250aW51b3VzIHJlc3BvbnNlIHZhcmlhYmxlIGFuZCBvbmUgY29udGludW91cyBwcmVkaWN0b3IgdmFyaWFibGUNCg0KJCRZID0gXGJldGFfMCArIFxiZXRhXzEgWCQkDQoNCndoZXJlIHRoZSBwYXJhbWV0ZXJzICRcYmV0YV8wJCAgPSBpbnRlcmNlcHQgYW5kICRcYmV0YV8xJCA9IHNsb3BlDQoNCmBgYHtyIGdlbmVyYWwtbG19DQpnZ3Bsb3QodHJlZXMsIGFlcyhHaXJ0aCwgSGVpZ2h0KSkgKw0KICBnZW9tX3Ntb290aChtZXRob2QgPSAibG0iLCBzZSA9IEYpICsNCiAgeGxhYigiUHJlZGljdG9yIHZhcmlhYmxlLCBYIikgKw0KICB5bGFiKCJSZXNwb25zZSB2YXJpYWJsZSwgWSIpICsNCiAgdGhlbWUoYXhpcy50aWNrcyA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF9ibGFuaygpKSArDQogIGFubm90YXRlKCJ0ZXh0IiwgMTQsIDc2LCBsYWJlbCA9ICJzbG9wZSIsIGFuZ2xlID0gNDApICsNCiAgIGFubm90YXRlKCJ0ZXh0IiwgMTAsIDcxLCBsYWJlbCA9ICJpbnRlcmNlcHQiKQ0KYGBgDQoNClNvIGZhciB0aGVzZSBwYXJhbWV0ZXJzIGhhdmUgYmVlbiAqZml4ZWQqLi4uDQoNCiMgUGFyYW1ldGVycyBvZiBhIGxpbmVhciBtb2RlbCBjYW4gYmUgKipyYW5kb20qKiBvciAqKmZpeGVkKioNCg0KKiBJbXBvcnRhbnQgdG8gY29uc2lkZXIgd2hlbiBkZXNpZ25pbmcgZXhwZXJpbWVudHMg4oCTIHlvdSBkZWNpZGUhDQoqIENoYW5nZXMgdGhlIGh5cG90aGVzZXMgJiBpbnRlcnByZXRhdGlvbiBvZiByZXN1bHRzDQoqIEZpeGVkOg0KICBDb25zdGFudCBhY3Jvc3MgYWxsIGdyb3VwaW5ncyAoaG93IG9ic2VydmF0aW9ucyBhcmUgcmVsYXRlZCDigJMgZS5nLiBwb3B1bGF0aW9ucyBvZiBpbmRpdmlkdWFscykNCiogUmFuZG9tOg0KIFZhcnkgYWNyb3NzIGdyb3VwaW5ncywgb3IgcmVwcmVzZW50IGEgcmFuZG9tIHNhbXBsZSBmcm9tIGEgbGFyZ2VyIHBvcHVsYXRpb24NCg0KIyMgRml4ZWQgc2xvcGVzIGxpbmVhciBtb2RlbA0KDQoqIEFsbCBncm91cHMgKEZyZXF1ZW5jeSBvZiBleGVyY2lzZSBpbiB0aGlzIGV4YW1wbGUpIGhhdmUgdGhlIHNhbWUgc2xvcGUNCiogUmVzcG9uc2Ugb2YgZ3JvdXBzIHRvIHByZWRpY3RvciB2YXJpYWJsZSB4IGlzIGNvbnNpc3RlbnQgYWNyb3NzIGdyb3Vwcw0KKiBDYW5ub3QgZXh0cmFwb2xhdGUgYmV5b25kIGdyb3Vwcw0KKiAqVGh1cyBjYW4gb25seSBkcmF3IGNvbmNsdXNpb25zIGZvciB0aGVzZSBncm91cHMqDQoNCmBgYHtyIGZpeGVkLXNsb3Blcy1tb2RlbCwgZmlnLmNhcCA9ICJIZWlnaHQgb2Ygc3R1ZGVudHMgb2YgdmFyaW91cyBmcmVxdWVuY2llcyBvZiBleGVyY2lzZSBhbmQgaGFuZCB3aWR0aCJ9DQpmaXRsbSA8LSBjb2VmKGxtKEhlaWdodCB+IFdyLkhuZCArIEV4ZXIsIGRhdGEgPSBzdXJ2ZXkpKQ0KDQpnZ3Bsb3Qoc3VydmV5LCBhZXMoV3IuSG5kLCBIZWlnaHQsIGNvbG9yID0gRXhlcikpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgZ2VvbV9hYmxpbmUoaW50ZXJjZXB0ICA9IGZpdGxtWzFdLCBzbG9wZSA9IGZpdGxtWzJdLCBjb2xvdXIgPSB2aXJpZGlzOjp2aXJpZGlzKDMpWzFdLCBsd2QgPSAxKSArDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCAgPSBmaXRsbVsxXStmaXRsbVszXSwgc2xvcGUgPSBmaXRsbVsyXSwgY29sb3VyID0gdmlyaWRpczo6dmlyaWRpcygzKVsyXSwgbHdkID0gMSkrDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCAgPSBmaXRsbVsxXStmaXRsbVs0XSwgc2xvcGUgPSBmaXRsbVsyXSwgIGNvbG91ciA9IHZpcmlkaXM6OnZpcmlkaXMoMylbM10sIGx3ZCA9IDEpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIpDQpgYGANCg0KIyMgUmFuZG9tIHNsb3BlcyBsaW5lYXIgbW9kZWwNCg0KKiBBbGwgZ3JvdXBzIGhhdmUgZGlmZmVyZW50IHNsb3Blcw0KKiBSZXNwb25zZSBvZiBncm91cHMgdG8gcHJlZGljdG9yIHZhcmlhYmxlIHggdmFyaWVzIGFtb25nIGdyb3Vwcw0KKiBDYW4gZXh0cmFwb2xhdGUgYmV5b25kIG9ic2VydmVkIGdyb3Vwcw0KKiBJZGVudGl0eSBvZiBncm91cCBpcyBub3QgdGhlIG1haW4gcXVlc3Rpb24NCiogKlRodXMgY2FuIGdlbmVyYWxpc2UgdG8gb3RoZXIgZ3JvdXBzIG91dHNpZGUgc3R1ZHkqDQoNCmBgYHtyIHJhbmRvbS1zbG9wZXMtbW9kZWwsIGZpZy5jYXAgPSAiRWFjaCBncm91cCBoYXMgYSBkaWZmZXJlbnQgc2xvcGUifQ0KZ2dwbG90KHN1cnZleSwgYWVzKFdyLkhuZCwgSGVpZ2h0LCBjb2xvdXIgPSBFeGVyKSkgKyANCiAgZ2VvbV9wb2ludCgpICsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPSBGQUxTRSkNCmBgYA0KDQojIyBEaXN0aW5ndWlzaGluZyBiZXR3ZWVuIEZpeGVkIG9yIHJhbmRvbSBpcyBpbXBvcnRhbnQNCg0KPiBDaGFuZ2VzIHRoZSB3YXkgQW5hbHlzaXMgb2YgVmFyaWFuY2UgKEFOT1ZBKSBpcyBjYWxjdWxhdGVkDQoNCiogQ2hhbmdlcyBmb3JtdWxhIGZvciBNZWFuIFN1bSBvZiBTcXVhcmVzDQoqIENoYW5nZXMgbnVtZXJhdG9yL2Rlbm9taW5hdG9yIG9mIEYgcmF0aW8NCiogVGh1cyBjaGFuZ2VzIGludGVycHJldGF0aW9uDQoqIENhbGxlZCBUeXBlIEkgKGZpeGVkKSwgSUkgKHJhbmRvbSkgb3IgSUlJIChtaXhlZCkNCg0KKioqDQoNCiMgdC10ZXN0cywgc2ltcGxlIGxpbmVhciBtb2RlbHMsIEFOT1ZBDQoNCiogUHJlZGljdG9yIHZhcmlhYmxlcyBjYW4gYmUgY2F0ZWdvcmljYWwgKGNhbGxlZCBmYWN0b3JzIGluIFIpLCBsaWtlIGV4ZXJjaXNlIGluIEZpZ3VyZXMgXEByZWYoZmlnOmZpeGVkLXNsb3Blcy1tb2RlbCkgJiBcQHJlZihmaWc6cmFuZG9tLXNsb3Blcy1tb2RlbCkNCiogQ2FuIGhhdmUgdHdvIG9yIG1vcmUgc3ViLWNhdGVnb3JpZXMgKGNhbGxlZCBsZXZlbHMgaW4gUikNCiAgKiBFLmcuIHNleDogbWFsZS9mZW1hbGUsIGxldmVsIG9mIGRydWc6IGxvdy9tZWRpdW0vaGlnaCAgDQoNClR5cGljYWxseSwgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGEgY29udGludW91cyByZXNwb25zZSB2YXJpYWJsZSAmIGNhdGVnb3JpY2FsIHByZWRpY3RvcnMgaXMgYW5hbHlzZWQgdXNpbmcgYSBzcGVjaWFsIGNhc2Ugb2Ygc3RhdGlzdGljYWwgbW9kZWxzOiBPbmUtd2F5IEFuYWx5c2lzIG9mIFZhcmlhbmNlIChBTk9WQSkgIA0KDQpDb25mdXNpbmdseSwgQU5PVkEgY2FuIHJlZmVyIHRvIGhvdyBkYXRhIGFyZSBzcHJlYWQgYXJvdW5kIGEgc2luZ2xlIG1lYW4gKCp2YXJpYW5jZSopIGFuZCBhbHNvIGEgd2F5IG9mIGNvbXBhcmluZyBtZWFucyAodmlhIGhvdyBzaW1pbGFyIHRoZWlyIHZhcmlhbmNlcyBhcmUpIGZvciBleHBlcmltZW50YWwgZGVzaWducyB3aXRoIGEgcHJlZGljdG9yIHZhcmlhYmxlIHdpdGggYW55IG51bWJlciBvZiBsZXZlbHMuDQoNCiMgRml4ZWQgb25lLXdheSBBTk9WQSB3aXRoIDIgb3IgbW9yZSBsZXZlbHMNCg0KKiBsZXZlbCA9IHN1YnNldHMgd2l0aGluIGNhdGVnb3JpZXMNCiAgKiBlLmcuIG1hbGUvZmVtYWxlLCBsb3cvbWVkaXVtL2hpZ2gNCiogV2UgYXJlIHRlc3RpbmcgbWVhbnMgZm9yIGVhY2ggbGV2ZWwNCiogV2hhdCBpcyB0aGUgbnVsbCBoeXBvdGhlc2lzPw0KDQo+ICRIXzA6JCBBbGwgbGV2ZWxzIGNvbWUgZnJvbSB0aGUgc2FtZSBwb3B1bGF0aW9uIChoYXZlIHRoZSBzYW1lIG1lYW4pDQoNCiMjIFB1bHNlIHJhdGUgYW5kIGV4ZXJjaXNlDQoNCmBgYHtyIHB1bHNlfQ0KZ2dwbG90KHN1cnZleSwgYWVzKEV4ZXIsIFB1bHNlKSkgKw0KICBnZW9tX2JveHBsb3QoKQ0KYGBgDQoNCldlIGNhbiBkbyBhbiBBTk9WQSBhbmQgZ2V0IHRoZSBmb2xsb3dpbmcgb3V0cHV0Og0KDQpgYGB7ciBwdWxzZS1hbm92YX0NCmxtX3B1bHNlIDwtIGxtKFB1bHNlIH4gRXhlciwgc3VydmV5KQ0KYW5vdmEobG1fcHVsc2UpDQpgYGANCg0KPiBDb25jbHVzaW9uczogV2UgY2FuIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzIHRoYXQgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBpbiBtZWFuIHB1bHNlIHJhdGUgb2Ygc3R1ZGVudHMgd2l0aCBkaWZmZXJlbnQgYW1vdW50IG9mIGV4ZXJjaXNlDQoNClJlcG9ydCB0aGUgZGVncmVlcyBvZiBmcmVlZG9tIChkZiksIHRoZSBGIHJhdGlvIGFuZCB0aGUgUCB2YWx1ZSBsaWtlDQokJEZfezIsMTg5fSA9IDMuMzgsIFAgPSAwLjAzNiQkDQpXaGVyZSAyIGlzIHRoZSBkZiBvZiB0aGUgZ3JvdXBzIChgRXhlcmApIGFuZCAxODkgaXMgdGhlIGRmIG9mIHRoZSByZXNpZHVhbCBlcnJvciAoYFJlc2lkdWFsc2ApLg0KDQojIyBUaGUgQU5PVkEgdGFibGUNCg0KfCAgU291cmNlIG9mIHZhcmlhdGlvbiAgfCBTUyB8IGRmIHwgTVMgfCBGIHwgUCB8DQp8Oi0tLS0tLS0tLS0tLS0tLS0tLS0tLTp8Oi0tOnw6LS06fDotLTp8Oi06fC0tLXwNCnwgVmFyaWFuY2UgYW1vbmcgZ3JvdXBzIHwgU1NSIHwgbnVtYmVyIG9mIGxldmVscyAtIDEgfCAkTVNSID0gXGZyYWN7U1NSfXtkZn0kIHwgJFxmcmFje01TUn17TVNFfSQgfCAgIHwNCnwgVmFyaWFuY2Ugd2l0aGluIGdyb3VwIHwgU1NFIHwgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyAtIDIgfCAkTVNFID0gXGZyYWN7U1NFfXtkZn0kfCAgIHwgICB8DQp8ICAgICAgICBUb3RhbCBlcnJvciAgIHwgU1NZIHwgdG90YWwgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyAtIDEgfCAgICB8ICAgfCAgIHwNCg0KIyMgQ2FsY3VsYXRpbmcgZ3JvdXAgbWVhbnMNCg0KQ2hlY2sgYHN1bW1hcnkoKWAgdG8gc2VlIGdyb3VwIG1lYW5zDQoNCmBgYHtyIGdyb3VwLW1lYW5zfQ0Kc3VtbWFyeShsbV9wdWxzZSkNCmBgYA0KDQoqIEdyb3VwcyBhcmUgY2FsY3VsYXRlZCBpbiBhbHBoYWJldGljYWwgb3JkZXIgLSBIZXJlICJGcmVxdWVudCIgZ3JvdXAgaXMgY2FsY3VsYXRlZCBmaXJzdA0KKiBgRXN0aW1hdGVgIGNvbHVtbiBzaG93cyB0aGUgKipkaWZmZXJlbmNlIGluIG1lYW5zKiogLSBzZWUgYmVsb3cNCiogUCB2YWx1ZXMgdGVzdCBkaWZmZXJlbmNlcyBpbiAqKnBhaXJzIG9mIG1lYW5zKiogQlVUIHNob3VsZCB3ZSBiZSBkb2luZyBtdWx0aXBsZSBjb21wYXJpc29ucz8gKG5vKQ0KDQpNb2RlbCBjb2VmZmljaWVudHM6ICANCmBgYHtyIGNvZWZ9DQpjb2VmKGxtX3B1bHNlKQ0KYGBgDQoNClItY2FsY3VsYXRlZCBtZWFuczogDQpgYGB7ciBtZWFuc30NCiB0YXBwbHkoc3VydmV5JFB1bHNlLCBzdXJ2ZXkkRXhlciwgbWVhbiwgbmEucm0gPSBUKQ0KYGBgDQoNCk1hbnVhbGx5IGNhbGN1bGF0ZWQgbWVhbnMgZm9yICJOb25lIiBncm91cDogDQpgciBjb2VmKGxtX3B1bHNlKVsxXWAgKyBgciBjb2VmKGxtX3B1bHNlKVsyXWAgPSBgciBjb2VmKGxtX3B1bHNlKVsxXStjb2VmKGxtX3B1bHNlKVsyXWANCg0KTWFudWFsbHkgY2FsY3VsYXRlZCBtZWFucyBmb3IgIlNvbWUiIGdyb3VwOiANCmByIGNvZWYobG1fcHVsc2UpWzFdYCArIGByIGNvZWYobG1fcHVsc2UpWzNdYCA9IGByIGNvZWYobG1fcHVsc2UpWzFdK2NvZWYobG1fcHVsc2UpWzNdYA0KDQojIEFOT1ZBIGFuZCBoeXBvdGhlc2lzIHRlc3RpbmcNCg0KKipJbXBvcnRhbnQgdG8gcmVtZW1iZXI6KioNCg0KKiBBTk9WQSBpcyBhIHRlc3Qgb2YgbWVhbnMgKGFuYWx5c2lzIG9mIHZhcmlhbmNlIGFib3V0IHRoZSBtZWFuKQ0KKiBGLXJhdGlvIHRlbGxzIHlvdSB0aGF0IHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMgYmV0d2VlbiBwYWlycyBvZiBncm91cHMgYnV0IE5PVCB3aGljaCBwYWlycyBhcmUgZGlmZmVyZW50DQoqIE5lZWQgcG9zdC1ob2MgdGVzdHMgbGlrZSBUdWtleeKAmXMgSG9uZXN0IFNpZ25pZmljYW50IERpZmZlcmVuY2VzIChub3QgY292ZXJlZCBpbiB0aGlzIGxlY3R1cmUpIHRvIHNlZSAqd2hpY2ggcGFpcnMqIGFyZSBzaWduaWZpY2FudGx5IGRpZmZlcmVudA0KDQoqKioNCiMgUmVjYXAgdGltZSENCg0KVGVzdCB5b3VyIHVuZGVyc3RhbmRpbmcgc28gZmFyIGJ5IGFuc3dlcmluZyB0aGUgcXVlc3Rpb25zIGJlbG93LiBDbGljayBgQ29kZWAgdG8gc2VlIHRoZSBhbnN3ZXIuDQoNCldoYXQgaXMgdGhlIHNpZ25pZmljYW5jZSBvZiBmaXhlZCBhbmQgcmFuZG9tIHZhcmlhYmxlcyBmb3IgZHJhd2luZyBjb25jbHVzaW9ucz8NCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJywgZXZhbCA9IEZBTFNFLCBlY2hvID0gVFJVRX0NCkl0IGNoYW5nZXMgdGhlIGluZmVycmVkIGNvbmNsdXNpb24uIEluIGZpeGVkIG1vZGVscywgdGhlIGlkZW50aXRpZXMgb2YgdGhlIGdyb3VwaW5ncyBhcmUgdGhlIG1haW4gbGV2ZWwgb2YgaW5mZXJlbmNlIHdoZXJlYXMgaW4gcmFuZG9tIG1vZGVscyB3ZSBjb25zaWRlciB0aGUgaWRlbnRpdHkgb2YgdGhlIGdyb3VwIHRvIGJlIHJhbmRvbWx5IHNlbGVjdGVkIGZyb20gYSB3aWRlciBwb29sIG9mIGNhbmRpZGF0ZXMuIFRodXMgd2UgY2FuIGdlbmVyYWxpc2Ugb3VyIGZpbmRpbmdzIGJleW9uZCBvdXIgc2VsZWN0ZWQgZ3JvdXBzIGluIHJhbmRvbSBtb2RlbHMgYnV0IGFyZSBsaW1pdGVkIHRvIHRoZSBncm91cHMgd2Ugc2VsZWN0ZWQgaW4gZml4ZWQgbW9kZWxzLiANCg0KRm9yIGV4YW1wbGUsIGlmIHdlIGNvdW50ZWQgdGhlIHBvcHVsYXRpb24gb2YgNSB0b3ducyBpbiBJcmVsYW5kIGFuZCBhbmFseXNlZCB0aGUgZGF0YSB1c2luZyBhIGZpeGVkIG1vZGVsLCB0aGVuIHdlIGNvdWxkIG9ubHkgc3RhdGUgb3VyIGNvbmNsdXNpb24gZm9yIHRob3NlIDUgdG93bnMgYW5kIGNhbm5vdCBkcmF3IGNvbmNsdXNpb25zIGZvciB0aGUgd2hvbGUgb2YgSXJlbGFuZC4NCg0KV2l0aCBhIHJhbmRvbSBtb2RlbCwgd2UgY29uc2lkZXIgdGhvc2UgNSB0b3ducyB0byBiZSByZXByZXNlbnRpdGl2ZSBvZiB0aGUgd2hvbGUgb2YgSXJlbGFuZCwgd2UgYXJlIG5vdCBpbnRlcmVzdGVkIGluIHRob3NlIDUgdG93bnMgaW4gcGFydGljdWxhciwgdGh1cyB3ZSBjYW4gZ2VuZXJhbGlzZSBvdXIgY29uY2x1c2lvbnMgdG8gdGhlIHdob2xlIG9mIElyZWxhbmQuIEUuZy4gdGhvc2UgNSB0b3ducyB3ZXJlIHJhbmRvbWx5IHNlbGVjdGVkIGZyb20gYWxsIHRoZSBjYW5kaWRhdGUgdG93bnMgdG8gc3VydmV5Lg0KYGBgDQoNCldoYXQgaXMgdGhlIGZ1bmN0aW9uIHRvIGNvbmR1Y3QgYW4gQW5hbHlzaXMgb2YgVmFyaWFuY2UgaW4gUj8NCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJywgZXZhbCA9IEZBTFNFLCBlY2hvID0gVFJVRX0NCkVpdGhlciBzdW1tYXJ5KGFvdigpKSBvciBhbm92YShsbSgpKSB3aWxsIGRvIGEgVHlwZSBJIEFOT1ZBLiBUeXBlIElJIGFuZCBUeXBlIElJSSBtb2RlbHMgcmVxdWlyZSBhZGRpdGlvbmFsIHBhY2thZ2VzLg0KYGBgDQoNCkhvdyBtYW55IGdyb3VwcyB3ZXJlIGluIHRoZSBjYXRlZ29yaWNhbCBwcmVkaWN0b3IgdmFyaWFibGUgaW4gdGhpcyBvbmUtd2F5IGFuYWx5c2lzIG9mIHZhcmlhbmNlPyAkRl97NSwyNH0gPSAxNC4yMywgUCA8IDAuMDAxJA0KYGBge3IsIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnLCBldmFsID0gRkFMU0UsIGVjaG8gPSBUUlVFfQ0KNiBncm91cHMuIFRoZSBkZWdyZWUgb2YgZnJlZWRvbSBmb3IgZ3JvdXAgaXMgNSBhbmQgdGhpcyBpcyBjYWxjdWxhdGVkIGZyb20gdGhlIG51bWJlciBvZiBncm91cHMgLSAxLiBTbyA1ICsgMSA9IDYuDQpgYGANCg0KKioqDQoNCiMgTXVsdGlwbGUgcmVncmVzc2lvbg0KDQpXZSBjYW4gaW5jbHVkZSBtb3JlIHRoYW4gMSBwcmVkaWN0b3IgdmFyaWFibGUgaW4gb3VyIG1vZGVscw0KDQo+IE11bHRpcGxlIHJlZ3Jlc3Npb246IExpbmVhciBtb2RlbHMgd2l0aCB0d28gb3IgbW9yZSBwcmVkaWN0b3IgdmFyaWFibGVzDQoNCiogTW9kZWxzIHRoZSBlZmZlY3Qgb2YgbXVsdGlwbGUgcHJlZGljdG9ycyBvbiByZXNwb25zZQ0KKiBUd28td2F5IEFOT1ZBcyBldGMuIGFyZSBzcGVjaWFsIGNhc2VzIG9mIG11bHRpcGxlIHJlZ3Jlc3Npb24NCiogSWYgMyBjYXRlZ29yaWNhbCBwcmVkaWN0b3JzLCB0aGVuIHRocmVlLXdheSBBTk9WQSBldGPigKYNCiogV2l0aCBtb3JlIHByZWRpY3RvciB2YXJpYWJsZXMsIHRoZSBtb2RlbCBiZWNvbWVzIGNvbXBsZXgNCiAgKiBBbmQgcG90ZW50aWFsbHkgbGVzcyBpbmZvcm1hdGl2ZS9kaWZmaWN1bHQgdG8gaW50ZXJwcmV0DQogICogUmVtZW1iZXIgdGhlIHRyYWRlLW9mZiBiZXR3ZWVuIGdlbmVyYWxpdHkgJiBjb21wbGV4aXR5DQogICogS2VlcCBpdCBzaW1wbGUNCiAgDQojIyBIZWlnaHQgYW5kIGhhbmQgd2lkdGgNCg0KSW1hZ2luZSB3ZSBhc2tlZCB0aGUgY2xhc3Mg4oCYaXMgdGhlcmUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiB5b3VyIGhlaWdodCBhbmQgdGhlIHdpZHRoIG9mIHlvdXIgaGFuZD/igJkgIA0KVGhlIGxpbmVhciBtb2RlbCBpczoNCg0KJCQgaGVpZ2h0ICA9IFxiZXRhXzAgKyBcYmV0YV8xIGhhbmQgXHNwYWNlIHdpZHRoICsgXHZhcmVwc2lsb25faSQkDQoNCmBgYHtyIGhhbmQtaGVpZ2h0LCBmaWcuY2FwID0gIlRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBoYW5kIHdpZHRoIGFuZCBoZWlnaHQgb2Ygc3R1ZGVudHMifQ0KaF9oYW5kIDwtIGdncGxvdChuYS5vbWl0KHN1cnZleSksIGFlcyhXci5IbmQsIEhlaWdodCkpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgeGxhYigiSGFuZCB3aWR0aCIpICArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKQ0KaF9oYW5kDQpgYGANCg0KR29vZCwgYnV0IGxldCdzIGFzayBpcyBpdCBhbHNvIGltcG9ydGFudCB0byBjb25zaWRlciB0aGUgc2V4IG9mIHRoZSBzdHVkZW50Pw0KDQpgYGB7ciBoYW5kLWhlaWdodC1zZXgsIGZpZy5jYXAgPSAiVGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGhhbmQgd2lkdGggYW5kIGhlaWdodCBvZiBtYWxlICh5ZWxsb3cpIG9yIGZlbWFsZSAocHVycGxlKSBzdHVkZW50cyJ9DQpoX2hhbmQgKyBhZXMoY29sb3VyID0gU2V4KQ0KYGBgDQoNCj4gRG9lcyBpbmNsdWRpbmcgaW5mb3JtYXRpb24gYWJvdXQgc2V4IGltcHJvdmUgb3VyIGFiaWxpdHkgdG8gZGV0ZWN0L3VuZGVyc3RhbmQgcGF0dGVybnM/DQoNClRoZSBsaW5lYXIgbW9kZWwgbm93IGhhcyB0d28gcHJlZGljdG9yIHZhcmlhYmxlcyBhbmQgaXMgd3JpdHRlbiBhczoNCg0KJCQgaGVpZ2h0ICA9IFxiZXRhXzAgKyBcYmV0YV97c2V4fSBoYW5kIFxzcGFjZSB3aWR0aCArIFx2YXJlcHNpbG9uX2kkJA0KTm90aWNlIHRoYXQgdGhlIHNsb3BlIHBhcmFtZXRlciAoJFxiZXRhX3tzZXh9JCkgbm93IHNwZWNpZmllcyB0aGF0IGl0IGlzIGRlcGVuZGVudCBvbiB0aGUgc2V4IG9mIHRoZSBzdHVkZW50LiAgDQoNClNpbmNlIFNleCBpcyBhIGNhdGVnb3JpY2FsIHByZWRpY3RvciB3aXRoIDIgbGV2ZWxzLCB0aGlzIG1vZGVsIG5vdyBkZXNjcmliZXMgdHdvIGxpbmVzIC0gb25lIGZvciBlYWNoIGxldmVsIG9mIHRoZSBwcmVkaWN0b3IgKG1hbGUvZmVtYWxlKQ0KDQojIyMgRG9lcyBzdHVkZW50IGhlaWdodCB2YXJ5IHdpdGggaGFuZCB3aWR0aCBhbmQgYmV0d2VlbiBzZXhlcz8NCg0KKiBDb250aW51b3VzIHJlc3BvbnNlDQoqIENhdGVnb3JpY2FsIHByZWRpY3Rvcg0KKiBDb250aW51b3VzIHByZWRpY3RvciAoYWxzbyBjYWxsZWQgY292YXJpYXRlKQ0KKiBDYW4gYmUgYW5hbHlzZWQgdXNpbmcgbXVsdGlwbGUgbGluZWFyIG1vZGVscw0KKiBUd28gdHlwZXM6DQogICogQWRkaXRpdmUgbW9kZWwgKCoqRml4ZWQgc2xvcGVzIG1vZGVsKiopDQogICogSW50ZXJhY3RpdmUgbW9kZWwgKCoqUmFuZG9tIHNsb3BlcyBtb2RlbCoqKQ0KICANCkFuYWx5c2lzIG9mIENvdmFyaWFuY2UgaXMgYSBzcGVjaWFsIGNhc2Ugd2l0aCB1bmlxdWUgYXNzdW1wdGlvbnMgKG5vdCBjb25zaWRlcmVkIGhlcmUpLCBlbHNlIGNhbGxlZCBhIGdlbmVyYWwgbGluZWFyIG1vZGVsDQoNCiMjIEZpeGVkIHNsb3BlcyAoYWRkaXRpdmUgbW9kZWwpDQoNCiogTm8gaW50ZXJhY3Rpb24gdGVybQ0KKiBTYW1lIHNsb3BlDQoqIEludGVyY2VwdCBmb3IgZWFjaCBzZXgNCiogaW4gYFJgOiBgbG0oWSB+IEEgKyBCLCBkYXRhKWAgd2hlcmUgQSAmIEIgYXJlIHRoZSB0d28gcHJlZGljdG9yIHZhcmlhYmxlcw0KDQo+IEgwOiBUaGVyZSBpcyBubyBlZmZlY3Qgb2YgQSBvciBCIG9uIHRoZSByZXNwb25zZSB2YXJpYWJsZQ0KPiBIMTogVGhlcmUgaXMgYW4gZWZmZWN0IG9mIEEgb3IgQiBvbiB0aGUgcmVzcG9uc2UgdmFyaWFibGUNCg0KYGBge3Igc2FtZS1zbG9wZSwgZmlnLmNhcCA9ICJ0aGUgbGluZXMgYXJlIHBhcmFsbGVsIHRvIGVhY2ggb3RoZXIiLCAgZmlnLnNob3c9ImFzaXMifQ0KaF9oYW5kICsgDQogICBhZXMoY29sb3VyID0gU2V4KSArDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCA9IDEzMi41NDQ1LCBzbG9wZSA9IDEuODc2MCAgLCBjb2xvdXIgPSB2aXJpZGlzTGl0ZTo6dmlyaWRpcygyKVsxXSwgbHdkPTIpICsgDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCA9IDEzMi41NDQ1KzkuMzE2NCwgc2xvcGUgPSAxLjg3NjAgICwgY29sb3VyID12aXJpZGlzTGl0ZTo6dmlyaWRpcygyKVsyXSwgbHdkPTIpDQoNCmxtX2hoYW5kIDwtIGxtKEhlaWdodCB+IFdyLkhuZCArIFNleCwgc3VydmV5KQ0KY29lZihsbV9oaGFuZCkNCmBgYA0KDQpQYXJhbWV0cmlzZWQgc2xvcGUgZm9yIGZlbWFsZXM6ICANCipGZW1hbGUgaGVpZ2h0KiA9IGByIHJvdW5kKGNvZWYobG1faGhhbmQpWzFdLDMpYCArIGByIHJvdW5kKGNvZWYobG1faGhhbmQpWzJdLDMpYCAqaGFuZCB3aWR0aCoNCg0KUGFyYW1ldHJpc2VkIHNsb3BlIGZvciBtYWxlczogIA0KKk1hbGUgaGVpZ2h0KiA9IChgciByb3VuZChjb2VmKGxtX2hoYW5kKVsxXSwzKWAgKyBgciByb3VuZChjb2VmKGxtX2hoYW5kKVszXSwzKWApICsgYHIgcm91bmQoY29lZihsbV9oaGFuZClbMl0sMylgICpoYW5kIHdpZHRoKg0KDQo+IFJlbWVtYmVyIFIgc2hvd3MgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBwYXJhbWV0ZXIgZXN0aW1hdGVzIHNvIHlvdSBuZWVkIHRvIGV4dHJhY3QgdGhlIGNvcnJlY3QgdmFsdWVzDQoNCiMjIFJhbmRvbSBzbG9wZXMgKGludGVyYWN0aXZlIG1vZGVsKQ0KDQpUaGUgcmFuZG9tIHNsb3BlcyBtb2RlbCBoYXMgaW4gaW50ZXJhY3Rpb24gdGVybS4gSW4gUiB0aGlzIGlzIGNvZGVkIGBsbShIZWlnaHQgfiBXci5IbmQgKiBTZXgsIHN1cnZleSlgLg0KDQpUaGUgbGluZWFyIG1vZGVsIGlzIG5vdzoNCg0KJCQgaGVpZ2h0ICA9IFxiZXRhX3swX3tzZXh9fSArIFxiZXRhX3tzZXh9IGhhbmQgXHNwYWNlIHdpZHRoICsgXHZhcmVwc2lsb25faSQkDQoNCmBgYHtyIHJhbmRvbS1zbG9wZXMsIGZpZy5jYXA9ICJUaGUgbGluZXMgaGF2ZSBkaWZmZXJlbnQgc2xvcGVzIGFuZCBpbnRlcmNlcHRzIiwgZmlnLnNob3c9ImFzaXMifQ0KaF9oYW5kICsgYWVzKGNvbG91ciA9IFNleCkgKw0KICBnZW9tX3Ntb290aChtZXRob2QgPSAibG0iLCBzZSA9IEYsIGx3ZCA9IDIsIGZ1bGxyYW5nZSA9IFRSVUUpIA0KDQpsbV9oaGFuZCA8LSB1cGRhdGUobG1faGhhbmQsIC4gfiAuICsgV3IuSG5kOlNleCkNCmNvZWYobG1faGhhbmQpDQpgYGANCg0KVG8gcGFyYW1ldHJpc2UgdGhlIG1vZGVsIHdlIG5vdyBuZWVkIHRvIGNhbGN1bGF0ZSBkaWZmZXJlbnQgdmFsdWVzIGZvciBzbG9wZXMuIEluIHRoZSBjb2VmZmljaWVudCBsaXN0LCBgV3IuSG5kOlNleE1hbGVgIGlzIHRoZSAqKmRpZmZlcmVuY2UgaW4gdGhlIHZhbHVlIG9mIHRoZSBzbG9wZSByZWxhdGl2ZSB0byB0aGUgc2xvcGUgZm9yIGZlbWFsZSoqIGBXci5IbmRgLiBSZW1lbWJlcjogZmVtYWxlIGlzIGFscGhhYmV0aWNhbGx5IGJlZm9yZSBtYWxlIHNvIFIgY2FsY3VsYXRlcyB0aGUgdmFyaWFuY2VzIGZvciBmZW1hbGVzIGZpcnN0LCB0aGVuIG1hbGVzLg0KDQpQYXJhbWV0cmlzZWQgc2xvcGUgZm9yIGZlbWFsZXM6ICANCipGZW1hbGUgaGVpZ2h0KiA9IGByIHJvdW5kKGNvZWYobG1faGhhbmQpWzFdLDMpYCArIGByIHJvdW5kKGNvZWYobG1faGhhbmQpWzJdLDMpYCAqaGFuZCB3aWR0aCoNCg0KUGFyYW1ldHJpc2VkIHNsb3BlIGZvciBtYWxlczogIA0KKk1hbGUgaGVpZ2h0KiA9IChgciByb3VuZChjb2VmKGxtX2hoYW5kKVsxXSwzKWAgYHIgcm91bmQoY29lZihsbV9oaGFuZClbM10sMylgKSArIChgciByb3VuZChjb2VmKGxtX2hoYW5kKVsyXSwzKWAgKyBgciByb3VuZChjb2VmKGxtX2hoYW5kKVs0XSwzKWApICpoYW5kIHdpZHRoKg0KDQo+IEgwOiBUaGVyZSBpcyBubyBlZmZlY3Qgb2YgQSBvciBCIG9yIHRoZWlyIGludGVyYWN0aW9uIG9uIHRoZSByZXNwb25zZSB2YXJpYWJsZQ0KPiBIMTogVGhlcmUgaXMgYW4gZWZmZWN0IG9mIEEgb3IgQiBvciB0aGVpciBpbnRlcmFjdGlvbiBvbiB0aGUgcmVzcG9uc2UgdmFyaWFibGUNCg0KKioqDQoNCiMjIFRoZSBtdWx0aXBsZSByZWdyZXNzaW9uIEFOT1ZBIHRhYmxlDQoNCj4gVmFyaWFuY2Ugb2YgcHJlZGljdG9ycyAoU1MpIGlzIHBhcnRpdGlvbmVkIG91dCBmcm9tIHRvdGFsIFNTIGluIG9yZGVyIGl0IGlzIGVudGVyZWQgaW4gdG8gUg0KDQpgYGB7ciBhbm92YS10YWJsZS1oYW5kfQ0Ka2FibGUoYW5vdmEobG1faGhhbmQpLCBkaWdpdHMgPSAzMikNCmBgYA0KDQojIyBUaGUgQU5PVkEgdGFibGUgZm9yIDIgcHJlZGljdG9ycyBhbmQgdGhlaXIgaW50ZXJhY3Rpb24NCg0KfCAgU291cmNlIG9mIHZhcmlhdGlvbiAgfCBTUyB8IGRmIHwgTVMgfCBGIHwgUCB8DQp8Oi0tLS0tLS0tLS0tLS0tLS0tLS0tLTp8Oi0tOnw6LS06fDotLTp8Oi06fC0tLXwNCnwgRmFjdG9yIEEgfCBTU1Igb2YgQSB8IG51bWJlciBvZiBsZXZlbHMgb2YgQSAtIDEgfCB8ICB8ICAgfA0KfCBGYWN0b3IgQiB8IFNTUiBvZiBCIHwgbnVtYmVyIG9mIGxldmVscyBvZiBCIC0gMSB8fCAgIHwgICB8DQp8IEZhY3RvciBBIHggQiB8IFNTUiBvZiBBICYgQiB8IGRmIG9mIEEgeCBkZiBvZiBCIHx8ICAgfCAgIHwNCnwgV2l0aGluIGVycm9yIHwgU1NFIHwgbGV2ZWxzIG9mIEEgeCBsZXZlbHMgb2YgQiBYIChudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIC0gMSkgfCB8ICAgfCAgIHwNCnwgIFRvdGFsIGVycm9yICAgfCBTU1kgfCAobGV2ZWxzIG9mIEEgeCBsZXZlbHMgb2YgQiBYIG51bWJlciBvZiBvYnNlcnZhdGlvbnMpIC0gMSB8ICAgIHwgICB8ICAgfA0KDQojIyBJbnRlcnByZXRpbmcgdGhlIEFOT1ZBIHRhYmxlDQoNCj4gUChJbnRlcmFjdGlvbiB0ZXJtKSA+IDAuMDUsIHRodXMgdGhlIGVmZmVjdCBvZiBoYW5kIHdpZHRoIG9uDQpzdHVkZW50IGhlaWdodCBpcyBub3QgZGVwZW5kZW50IG9mIHRoZSBzZXggb2YgdGhlIHN0dWRlbnQNCg0KDQpgYGB7ciBhbm92YS10YWJsZS1oYW5kLTJ9DQprYWJsZShhbm92YShsbV9oaGFuZCksIGRpZ2l0cyA9IDMyKQ0KYGBgDQoNCiMjIFRoZSBpbnRlcmFjdGlvbiB0ZXJtIEE6Qg0KDQoqIE1lYXN1cmVzIHRoZSBkZXBlbmRlbmNlIG9mIHRoZSBsZXZlbCBvZiBvbmUgZmFjdG9yIG9uIHRoZSBsZXZlbCBvZiB0aGUgb3RoZXIgZmFjdG9ycw0KKiBJZiBpbnRlcmFjdGlvbiB0ZXJtIGlzIG5vdCBzaWduaWZpY2FudDoNCiAgKiBlZmZlY3Qgb2Ygb25lIGZhY3RvciBvbiBvdGhlciBpcyBhZGRpdGl2ZSAoaW5kZXBlbmRlbnQgb2YgZWFjaCBvdGhlcikNCiogSWYgc2lnbmlmaWNhbnQ6DQogICogaW5kaWNhdGVzIHN5bmVyZ2lzdGljIG9yIGFudGFnb25pc3RpYyBlZmZlY3RzIGJldHdlZW4gZmFjdG9ycw0KICAqIFNob3VsZCBiZSBtYWluIGNvbmNsdXNpb24gb2YgYW5hbHlzaXMNCg0KKioqDQoNCiMgVGhlIGZ1bmRhbWVudGFscyBvZiBMaW5lYXIgcmVncmVzc2lvbg0KDQpUaGF0J3MgdGhlIGJhc2ljcyBvZiBsaW5lYXIgcmVncmVzc2lvbiEgIA0KVGhleSBhcmUgd2lkZWx5IHVzZWQgaW4gYmlvbG9naWNhbCBzdGF0aXN0aWNzIHNvIHlvdSdsbCBsaWtlbHkgY29tZSBhY3Jvc3MgdGhlbSB3aGVuIHJlYWRpbmcgc2NpZW50aWZpYyBzdHVkaWVzLiAgDQoNClRoZSBzYW1lIGNvbmNlcHRzIGFwcGx5IGZvciBhbnkgbnVtYmVyIG9yIGNvbWJpbmF0aW9uIG9mIHByZWRpY3RvciB2YXJpYWJsZXMuIFR3bywgdGhyZWUsIGZvdXIgcHJlZGljdG9yIHZhcmlhYmxlcyBhbmQgc28gZm9ydGguLi5pdCBqdXN0IGJlY29tZXMgbW9yZSBjb21wbGV4IHRvIHBhcmFtZXRlcmlzZS4gIA0KDQpSZW1lbWJlciwgdGhlIGFpbSBpcyB0byBxdWFudGlmeSBob3cgbXVjaCB2YXJpYXRpb24gaW4gdGhlIHJlc3BvbnNlIHZhcmlhYmxlIGlzIGF0dHJpYnV0YWJsZSB0byBlYWNoIHByZWRpY3RvciB2YXJpYWJsZSAtIG1pbmltaXNlIHRob3NlIHJlc2lkdWFscyENCg0KQ29tbW9uIHN0YXRpc3RpY2FsIGFuYWx5c2VzIHlvdSBzaG91bGQgYmUgYWJsZSB0byBkbyBieSBhcHBseWluZyB0aGUgY29uY2VwdHMgaW4gdGhlc2UgbGVjdHVyZXM6DQoxIGNvbnRpbnVvdXMgcmVzcG9uc2UgdmFyaWFibGUgJjoNCg0KKiAxIGNvbnRpbnVvdXMgcHJlZGljdG9yIHZhcmlhYmxlIC0gc2ltcGxlIGxpbmVhciByZWdyZXNzaW9uDQoqIDIgY29udGludW91cyBwcmVkaWN0b3IgdmFyaWFibGVzICh3aXRoL3dpdGhvdXQgdGhlaXIgaW50ZXJhY3Rpb24pIC0gbXVsdGlwbGUgcmVncmVzc2lvbg0KKiAxIGNhdGVnb3JpY2FsIHByZWRpY3RvciB2YXJpYWJsZSAtIE9uZS13YXkgQU5PVkENCiogMSBjb250aW51b3VzIHByZWRpY3RvciB2YXJpYWJsZSAmIDEgY2F0ZWdvcmljYWwgcHJlZGljdG9yIHZhcmlhYmxlICh3aXRoL3dpdGhvdXQgdGhlaXIgaW50ZXJhY3Rpb24pIC0gQU5DT1ZBL211bHRpcGxlIHJlZ3Jlc3Npb24NCiogMiBjYXRlZ29yaWNhbCBwcmVkaWN0b3IgdmFyaWFibGVzICh3aXRoL3dpdGhvdXQgdGhlaXIgaW50ZXJhY3Rpb24pIC0gVHdvLXdheSBBTk9WQQ0KDQoqKioNCg0KIyBSZWNhcCB0aW1lIQ0KDQpUZXN0IHlvdXIgdW5kZXJzdGFuZGluZyBzbyBmYXIgYnkgYW5zd2VyaW5nIHRoZSBxdWVzdGlvbnMgYmVsb3cuIENsaWNrIGBDb2RlYCB0byBzZWUgdGhlIGFuc3dlci4NCg0KV2hhdCBpcyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGFuIGFkZGl0aXZlIGFuZCBpbnRlcmFjdGl2ZSBsaW5lYXIgbW9kZWw/IA0KYGBge3IsIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnLCBldmFsID0gRkFMU0UsIGVjaG8gPSBUUlVFfQ0KQW4gYWRkaXRpdmUgbW9kZWwgZG9lcyBub3QgZGVzY3JpYmUgYW4gaW50ZXJhY3Rpb24gYmV0d2VlbiB0aGUgdHdvIHByZWRpY3RvciB2YXJpYWJsZXMuIEFuIGludGVyYWN0aXZlIG1vZGVsIGRlc2NyaWJlcyB0aGF0IHRoZSBlZmZlY3Qgb2Ygb25lIHByZWRpY3RvciB2YXJpYWJsZSBvbiB0aGUgcmVzcG9uc2UgdmFyaWFibGUgaXMgZGVwZW5kZW50IG9uIHRoZSBzZWNvbmQgcHJlZGljdG9yIHZhcmlhYmxlLg0KYGBgDQoNCldoYXQgaXMgdGhlIGZ1bmN0aW9uIHRvIGNvbmR1Y3QgYW4gaW50ZXJhY3RpdmUgbXVsdGlwbGUgcmVncmVzc2lvbiBtb2RlbCBpbiBSPw0KYGBge3IsIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnLCBldmFsID0gRkFMU0UsIGVjaG8gPSBUUlVFfQ0KbG0oWSB+IEEgKiBCLCBkYXRhKSB3aGVyZSBBICYgQiBhcmUgdGhlIHR3byBwcmVkaWN0b3IgdmFyaWFibGVzLiAqIGRlbm90ZXMgdGhlIGludGVyYWN0aW9uLg0KYGBgDQoNCkEgbXVsdGlwbGUgcmVncmVzc2lvbiBvZiBjcmFiIHNoZWxsIHdpZHRoIChyZXNwb25zZSkgd2l0aCBjcmFiIGJvZHkgZGVwdGggKGNvbnRpbnVvdXMgcHJlZGljdG9yKSBmb3IgdHdvIHNwZWNpZXMgKGNhdGVnb3JpY2FsIHByZWRpY3RvcjogQiBvciBPKSBhbmQgdGhlaXIgaW50ZXJhY3Rpb24gaGFkIHRoZSBmb2xsb3dpbmcgY29lZmZpY2llbnRzOiAgDQpgciBrYWJsZShjb2VmKGxtKENXIH4gQkQgKiBzcCwgY3JhYnMpKSlgICANCldoYXQgaXMgdGhlIHByZWRpY3RlZCBzaGVsbCBsZW5ndGggKG1tKSBvZiBhIHNwZWNpZXMgTyBjcmFiIHdpdGggYSBib2R5IGRlcHRoIG9mIDE1bW0/DQoNCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJywgZXZhbCA9IEZBTFNFLCBlY2hvID0gVFJVRX0NCkFuc3dlcjogMzYuOTc5NTEgbW0NCg0KQmVjYXVzZSBCIGlzIGFscGhhYmV0aWNhbGx5IGJlZm9yZSBPLCB0aGUgZmlyc3QgcGFyYW1ldGVyIGNvZWZmaWNpZW50cyByZWZlciB0byBzcGVjaWVzIEIuIA0KVGhlIGludGVyY2VwdCBmb3Igc3BlY2llcyBPIGlzIDIuNjk0MjY0My0xLjI1MzE2MjQgPSAxLjQ0MTEwMg0KVGhlIHNsb3BlIGZvciBzcGVjaWVzIE8gaXMgIDIuNTQ0OTIwNi0wLjE3NTY5MzQgPSAyLjM2OTIyNw0KVGh1cyB0aGUgd2hvbGUgbW9kZWwgZm9yIHNwZWNpZXMgTyBpczoNCiAgc2hlbGwgbGVuZ3RoID0gMi4zNjkyMjcgKiBib2R5IGRlcHRoICsgMS40NDExMDINCg0KVXNpbmcgYSB2YWx1ZSBvZiAxNSBmb3IgYm9keSBkZXB0aDoNCiAgc2hlbGwgbGVuZ3RoID0gMi4zNjkyMjcgKiAxNSArIDEuNDQxMTAyDQogICAgICAgICAgICAgICA9IDM2Ljk3OTUxIG1tDQpgYGANCg0K</div>
<footer>
	    		<ul>
	    		    <li><i class="fas fa-home"></i><a href="https://jacintakongresearch.wordpress.com"> Jacinta D. Kong</a></li>
	        		<li><a class="fas fa-envelope" href="mailto:kongj@tcd.ie"></a></li>
	        		<li><a class="fab fa-twitter" href="https://twitter.com/jacintakong"></a></li>
				</ul>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("biostats-GLM2.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
